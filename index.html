<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Risk Assessment Tool for AI Act</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="description" content="" />
  <script src="https://unpkg.com/n3/browser/n3.min.js"></script>
  <script src="https://eyereasoner.github.io/eye-js/2/latest/index.js"></script>
  <style type="text/css">
    body {
      max-width: 800px;
      margin: auto;
      padding: 2px;
    }
    fieldset {
      width: 400px;
    }
    select {
      width: 400px;
    }
    #run {
      line-height: 2.5;
      border:  2px solid #222;
      margin-top: 5px;
    }
    #response {
      margin-top: 5px;
      border:  2px solid black;
      padding-left: 2px;
      font-family: monospace;
      width: 400px;
    }
    #preset-examples > li {
      padding: 1px;
      margin: 1px;
      border: 1px solid #333;
      background: #EEE;
      display: inline-block;
    }
    #random-example {
      padding: 1px;
      margin: 1px;
      border: 1px solid #333;
      background: #EEE;
    }
  </style>
</head>
<body>
  <h1>Risk Assessment Tool for AI Act</h1>
  <p>This tool provides a potential risk-level for the use of AI systems. Select one or more concepts and then click the <code>Check Risk Level</code> button. You can test various combinations or try pre-selected examples below or <span id="random-example">select random values</span>. The definitions of terms are provided at the <a href="#definitions">document end</a>.</p>
  <ul id="preset-examples">
    <li class="preset-example" data-domain="CriticalInfrastructure" data-purpose="ManagementAndOperationOfSafety">Management of Critical Infrastructure</li>
    <li class="preset-example" data-domain="Education" data-purpose="AssigningPeopleToEducationalInstitutions">Admissions in Educational Institutes</li>
  </ul>
  <hr/>
  <!-- TODO: Enable multiple select on each dropdown -->
  <!-- requires corresponding changes to the code handling the dropdown inputs -->
  <form>
    <fieldset>
      <legend>Domain:</legend>
      <select id="select-domain">
              <option selected="selected" value="">Any</option>
              <option value="AdministrationOfDemocraticProcesses">Administration Of Democratic Processes</option>
              <option value="AdministrationOfJustice">Administration Of Justice</option>
              <option value="Asylum">Asylum</option>
              <option value="BorderControl">Border Control</option>
              <option value="CriticalInfrastructure">Critical Infrastructure</option>
              <option value="Education">Education</option>
              <option value="Employment">Employment</option>
              <option value="LawEnforcement">Law Enforcement</option>
              <option value="Migration">Migration</option>
              <option value="PrivateService">Private Service</option>
              <option value="PublicService">Public Service</option>
              <option value="OtherDomain">Other</option>
            </select>
    </fieldset>
    <fieldset>
      <legend>Purpose:</legend>
      <select id="select-purpose">
        <option selected="selected" value="">Any</option>
        <option value="AdvertisingVacancies">Advertising Vacancies</option>
        <option value="ApplyingTheLawToFacts">Applying The Law To Facts</option>
        <option value="AssessingCreditworthiness">Assessing Creditworthiness</option>
        <option value="AssessingHealthRisk">Assessing Health Risk</option>
        <option value="AssessingPastCriminalBehaviour">Assessing Past Criminal Behaviour</option>
        <option value="AssessingPeopleRelatedRisk">Assessing People Related Risk</option>
        <option value="AssessingPersonalityTraits">Assessing Personality Traits</option>
        <option value="AssessingRiskForPotentialVictimsOfCriminalOffences">Assessing Risk For Potential Victims Of Criminal Offences</option>
        <option value="AssessingRiskOfIrregularImmigration">Assessing Risk Of Irregular Immigration</option>
        <option value="AssessingRiskOfOffending">Assessing Risk Of Offending</option>
        <option value="AssessingRiskOfReoffending">Assessing Risk Of Reoffending</option>
        <option value="AssessingSecurityRisk">Assessing Security Risk</option>
        <option value="AssigningPeopleToEducationalInstitutions">Assigning People To Educational Institutions</option>
        <option value="BorderControlSecurityCheck">Border Control Security Check</option>
        <option value="DeterminingAccessToEducation">Determining Access To Education</option>
        <option value="DeterminingAdmissionToEducationalInstitutions">Determining Admission To Educationa Institutions</option>
        <option value="DeterminingCreditScore">Determining Credit Score</option>
        <option value="DispatchingEmergencyService">Dispatching  Emergency Service</option>
        <option value="EvaluatingEligibilityToAccessPublicAssistanceServices">Evaluating Eligibility To Access Public Assistance Services</option>
        <option value="EvaluatingEmployeeBehaviour">Evaluating Employee Behaviour</option>
        <option value="EvaluatingEmployeePerformance">Evaluating Employee Performance</option>
        <option value="EvaluatingJobCandidates">Evaluating Job Candidates</option>
        <option value="EvaluatingLearningOutcomes">Evaluating Learning Outcomes</option>
        <option value="EvaluatingReliabilityOfEvidence">Evaluating Reliability Of Evidence</option>
        <option value="ExaminingAsylumApplication">Examining Asylum Application</option>
        <option value="ExaminingMigrationRelatedComplaints">Examining Migration Related Complaints</option>
        <option value="ExaminingResidencePermitsApplication">Examining Residence Permits Application</option>
        <option value="ExaminingVisaApplication">Examining Visa Application</option>
        <option value="GrantingPublicAssistanceServices">Granting Public AssistanceS ervices</option>
        <option value="HealthInsurancePricing">Health Insurance Pricing</option>
        <option value="HealthInsuranceRiskAssessment">Health Insurance Risk Assessment</option>
        <option value="InterpretingFacts">Interpreting Facts</option>
        <option value="InterpretingLaw">Interpreting Law</option>
        <option value="InvestigatingCriminalOffences">Investigating Criminal Offences</option>
        <option value="JobApplicationAnalysis">Job Application Analysis</option>
        <option value="JobApplicationFiltering">Job Application Filtering</option>
        <option value="LifeInsuranceRiskAssessment">Life Insurance Risk Assessment</option>
        <option value="MakingPromotionDecision">Making Promotion Decision</option>
        <option value="MakingTerminationDecision">Making Termination Decision</option>
        <option value="ManagementAndOperationOfSafety">Management And Operation Of Safety</option>
        <option value="MonitoringEmployeeBehaviour">Monitoring Employee Behaviour</option>
        <option value="MonitoringEmployeePerformance">Monitoring Employee Performance</option>
        <option value="PerformingBackgroundCheck">Performing Background Check</option>
        <option value="PredictingOccurrenceOfCriminalOffence">Predicting Occurrence Of Criminal Offence</option>
        <option value="PredictingReoccurrenceOfCriminalOffence">Predicting Reoccurrence Of Criminal Offence</option>
        <option value="PrioritisationOfEmergencyService">Prioritisation Of Emergency Service</option>
        <option value="ProsecutingCriminalOffences">Prosecuting Criminal Offences</option>
        <option value="ReclaimingPublicAssistanceServices">Reclaiming Public Assistance Services</option>
        <option value="Recruiting">Recruiting</option>
        <option value="ReducingPublicAssistanceServices">Reducing Public Assistance Services</option>
        <option value="RemoteIdentificationOfPeople">Remote Identification Of People</option>
        <option value="RevokingPublicAssistanceServices">Revoking Public Assistance Services</option>
        <option value="VerificationOfAsylumSeekerClaims">Verification Of Asylum Seeker Claims</option>
        <option value="VerificationOfMigrationSeekerClaims">Verification Of Migration Seeker Claims</option>
        <option value="OtherPurpose">Other</option>
      </select>
    </fieldset>
    <fieldset>
      <legend>Capability:</legend>
      <select id="select-capability"  >
          <option selected="selected" value="">Any</option>
          <option value="ActionRecognition">Action Recognition</option>
          <option value="AutomaticSummarisation">Automatic Summarisation</option>
          <option value="BehaviourAnalysis">Behaviour Analysis</option>
          <option value="BiometricIdentification">Biometric Identification</option>
          <option value="ComputerVision">Computer Vision</option>
          <option value="DialogueManagement">Dialogue Management</option>
          <option value="EmotionRecognition">Emotion Recognition</option>
          <option value="FaceRecognition">Face Recognition</option>
          <option value="GestureRecognition">Gesture Recognition</option>
          <option value="ImageRecognition">Image Recognition</option>
          <option value="InformationRetrieval">Information Retrieval</option>
          <option value="LieDetection">Lie Detection</option>
          <option value="MachineTranslation">Machine Translation</option>
          <option value="MusicInformationRetrieval">Music Information Retrieval</option>
          <option value="NamedEntityRecognition">Named Entity Recognition</option>
          <option value="NaturalLanguageGeneration">Natural Language Generation</option>
          <option value="ObjectRecognition">Object Recognition</option>
          <option value="PartOfSpeechTagging">Part Of Speech Tagging</option>
          <option value="PatternRecognition">Pattern Recognition</option>
          <option value="PersonalityTraitsAnalysis">Personality Traits Analysis</option>
          <option value="Profiling">Profiling</option>
          <option value="QuestionAnswering">Question Answering</option>
          <option value="RelationshipExtraction">Relationship Extraction</option>
          <option value="SentimentAnalysis">Sentiment Analysis</option>
          <option value="SoundEventRecognition">Sound Event Recognition</option>
          <option value="SoundSourceSeparation">Sound Source Separation</option>
          <option value="SoundSynthesis">Sound Synthesis</option>
          <option value="SpeakerRecognition">Speaker Recognition</option>
          <option value="SpeechRecognition">Speech Recognition</option>
          <option value="SpeechSynthesis">Speech Synthesis</option>
          <option value="OtherCapability">Other</option>
        </select>
    </fieldset>
    <fieldset>
      <legend>User:</legend>
      <select id="select-user"  >
        <option selected="selected" value="">Any</option>
        <option value="CompetentPublicAuthority">Competent Public Authority </option>
        <option value="CompetentPublicAuthorityRepresentative">Competent Public Authority Representative</option>
        <option value="EmergencyService">Emergency Service</option>
        <option value="FirstResponder">First Responder</option>
        <option value="JudicialAuthority">Judicial Authority </option>
        <option value="JudicialAuthorityRepresentative">Judicial Authority Representative</option>
        <option value="LawEnforcementAuthority">Law Enforcement Authority</option>
        <option value="LawEnforcementAuthorityRepresentative">Law Enforcement Authority Representative</option>
        <option value="NationalPublicAuthority">National Public Authority</option>
        <option value="PublicAuthority">Public Authority</option>
        <option value="PublicAuthorityRepresentative">Public Authority Representative</option>
        <option value="OtherUser">Other</option>
        </select>
    </fieldset>
    <fieldset>
      <legend>Subject:</legend>
      <select id="select-subject" >
        <option selected="selected" value="">Any</option>
        <option value="AsylumSeeker">Asylum Seeker</option>
        <option value="CourseApplicant">Course Applicant</option>
        <option value="Employee">Employee</option>
        <option value="Group">Group</option>
        <option value="JobApplicant">Job Applicant</option>
        <option value="NaturalPerson">Natural Person</option>
        <option value="Passenger">Passenger</option>
        <option value="Perpetrator">Perpetrator</option>
        <option value="PotentialJobApplicant">Potential Job Applicant</option>
        <option value="PublicServicesApplicant">Public Services Applicant</option>
        <option value="ResidencePermitApplicant">Residence Permit Applicant</option>
        <option value="Suspect">Suspect</option>
        <option value="Victim">Victim</option>
        <option value="VisaApplicant">Visa Applicant</option>
          <option value="OtherSubject">Other</option>
            </select>
    </fieldset>

  </form>
  <button id="run">Check Risk Level</button>
  <hr/>
  <h3>Results</h3>
  <div id="response">results will appear here</div>

  <hr/>

  <section id="definitions">
    <h2>Definitions</h2>
    <p>Inputs are described in terms of the following concepts. For more details on the creation of the tool, methodology, and discussion - refer to the <a href="#acknowledgements">peer-reviewed publication</a>.</p>
    <ul>
      <li><code>Domain</code>: the domain or sector or area within which the AI system is or will be deployed; e.g. Health, Education</li>
      <li><code>Purpose</code>: the purpose or end-goal for which the AI system is or will be used to achieve; e.g. Patient Diagnosis, Exam Assessment</li>
      <li><code>Capability</code>: the capability or application for what the AI system is or will be used to provide; e.g. Facial Recognition, Sentiment Analysis</li>
      <li><code>User</code>: the user or operator who is or will be using the AI system; e.g. Doctor, Teacher</li>
      <li><code>Subject</code>: the subject or individual or group which the AI system is or will be used towards; e.g. Patients, Students</li>
    </ul>

     <p>The outputs represent a potential risk level that represents whether the selected combination satisfies the AI Act Annex III:</p>
     <ul>
      <li>High-risk means there is an exact match</li>
      <li>Medium-risk means the combination can lead to a potential match (e.g. when the Purpose can take <i>Any</i> value)</li>
      <li>Low-risk means the output does not match any clause (i.e. not high-risk) and does not have the potential to match any cause (i.e. not medium-risk).</li>
    </ul>
  </section>
  
  <hr/>

  <section id="acknowledgements">
    <h2>Acknowledgements</h2>
    <p>This implementation is by <a href="https://harshp.com/">Harshvardhan J. Pandit</a> based on the below work. Source code is available via <a href="https://github.com/coolharsh55/ai_act_risk">GitHub repo</a> under a permissive license.</p>
    <p>Cite this work as: <i>Delaram Golpayegani, Harshvardhan J. Pandit, and Dave Lewis</i>. "<strong>To Be High-Risk, or Not To Be—Semantic Specifications and Implications of the AI Act’s High-Risk AI Applications and Harmonised Standards</strong>" Proceedings of the 2023 ACM Conference on Fairness, Accountability, and Transparency. 2023. <a href="https://doi.org/10.1145/3593013.3594050">https://doi.org/10.1145/3593013.3594050</a></p>
  </section>
<script>
// Load the rules file
var rules = "";
document.addEventListener("DOMContentLoaded", function(){
  fetch("rules.n3").then((res) =>res.text()).then((txt) =>{
    rules = txt ; 
    console.log("rules loaded successfully: " + rules.length);
  });
});

document.addEventListener("DOMContentLoaded", function(){
  // Implement pre-configured examples
  for(var example of document.getElementsByClassName("preset-example")) {
    example.addEventListener("click", function(ele) {
      // Domain
      if(ele.target.dataset.domain != undefined) {
        for(const option of document.getElementById('select-domain')) {
          if(option.value == ele.target.dataset.domain) {
            document.getElementById('select-domain').value = option.value;
            break;
          }
        }
      }
      // Purpose
      if(ele.target.dataset.purpose != undefined) {
        for(const option of document.getElementById('select-purpose')) {
          if(option.value == ele.target.dataset.purpose) {
            document.getElementById('select-purpose').value = option.value;
            break;
          }
        }
      }

      // run the reasoner via on click event
      document.getElementById('run').click();
    });
  };

  // Implement random selection
  var randomise_option =  function(list) {
    list.value = list[Math.floor(Math.random() * list.length)].value;
  }
  document.getElementById("random-example").addEventListener("click", async() => {
    randomise_option(document.getElementById('select-domain'));
    randomise_option(document.getElementById('select-purpose'));
    randomise_option(document.getElementById('select-capability'));
    randomise_option(document.getElementById('select-user'));
    randomise_option(document.getElementById('select-subject'));
    document.getElementById('run').click();
  });
});

// TODO: Implement features for Capability, User, Subject
// currently only Domain and Purpose are used for demo

// Run the reasoner on input submission
document.getElementById('run').addEventListener("click", async () =>{
  // Get data about AI System
  var domain = document.getElementById("select-domain").value;
  if (!domain) { domain = "GeneralDomain"; }
  // console.log("domain: " + domain);
  var purpose = document.getElementById("select-purpose").value;
  if (!purpose) { purpose = "GeneralPurpose"; }
  // console.log("purpose: " + purpose);

  // TODO: replace hacky text with actual RDF statements
  var data_graph = rules;
  data_graph += "\nai:System airo:hasDomain vair:" + domain + "." ;
  data_graph += "\nai:System airo:hasPurpose vair:" + purpose + "." ;
  // console.log(data_graph);

  // TODO: add rdfs reasoning to EYE rules so that a taxonomy can be used
  // in the reasoning of risk levels

  var results = (await eyereasoner.n3reasoner(
    data_graph, undefined, 
    { output: "deductive_closure", outputType: "quads" }));
  // console.log(results);

  const store = new N3.Store();
  const { DataFactory } = N3;
  const { namedNode, literal, defaultGraph, quad } = DataFactory;
  for(const quad of results) {
    store.add(quad);
  };

  results = "Results:";
  for (const quad of store.match(null, namedNode('https://w3id.org/airo#isHighRiskBy'), null)) {
    results += "<br/>High-risk clause matched: ";
    for(const clause of store.match(namedNode(quad.object.id), null, null)) {
      results += clause.object.value;
    }
  }
  for (const quad of store.match(null, namedNode('https://w3id.org/airo#isMediumRiskBy'), null)) {
    results += "<br/>Medium-risk with potential for High-Risk clause: ";
    for(const clause of store.match(namedNode(quad.object.id), null, null)) {
      results += clause.object.value;
    }
  }
  for (const quad of store.match(null, namedNode('https://w3id.org/airo#isLowRiskBy'), null)) {
    results += "<br/>Low-risk as no high-risk clause or condition matched";
  }

  document.getElementById('response').innerHTML = results;
  // console.log(results);
});
</script>
</body>
</html>