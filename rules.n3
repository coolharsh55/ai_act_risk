@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>.
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#>.
@prefix log: <http://www.w3.org/2000/10/swap/log#> . 
@prefix ai: <http://example.org/input#> .
@prefix airo: <https://w3id.org/airo#> .
@prefix vair: <https://w3id.org/vair#> .

# Testing Data
# ai:System airo:hasDomain vair:CriticalInfrastructure .
# ai:System airo:hasPurpose vair:Analytics .

# Annex III-2a

airo:AIAct-AnnexIII2a rdfs:label "Annex III 2-a" .

{ ai:System airo:hasDomain vair:CriticalInfrastructure . 
} => { ai:System airo:hasHighRiskDomain airo:AIAct-AnnexIII2a . } .
{ ai:System airo:hasPurpose vair:ManagementAndOperationOfSafety . 
} => { ai:System airo:hasHighRiskPurpose airo:AIAct-AnnexIII2a . } .

# General Domain
{ ai:System airo:hasDomain vair:GeneralDomain . 
} => { ai:System airo:hasMediumRiskDomain airo:AIAct-AnnexIII2a . } .
# General Purpose
{ ai:System airo:hasPurpose vair:GeneralPurpose . 
} => { ai:System airo:hasMediumRiskPurpose airo:AIAct-AnnexIII2a . } .

# High Risk
{
    ai:System airo:hasHighRiskDomain ?clause .
    ai:System airo:hasHighRiskPurpose ?clause .
} => { ai:System airo:isHighRiskBy ?clause } .

# Medium Risk
{
    ai:System airo:hasHighRiskDomain ?clause .
    ai:System airo:hasMediumRiskPurpose ?clause .
} => { ai:System airo:isMediumRiskBy ?clause } .
{
    ai:System airo:hasMediumRiskDomain ?clause .
    ai:System airo:hasHighRiskPurpose ?clause .
} => { ai:System airo:isMediumRiskBy ?clause } .
{
    ai:System airo:hasMediumRiskDomain ?clause .
    ai:System airo:hasMediumRiskPurpose ?clause .
} => { ai:System airo:isMediumRiskBy ?clause } .

# Low Risk
{
    ?graph log:notIncludes { ai:System airo:isHighRiskBy ?clause } .
    ?graph log:notIncludes { ai:System airo:isMediumRiskBy ?clause } .
} => { ai:System airo:isLowRiskBy airo:NoClauseFound } .